{# templates/core/sidebar_base.html #}
{% extends "core/base.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    {% if user.role == 'student' %}
                        <li class="nav-item">
                            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
                                <i class="fas fa-home"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'courses' in request.path %}active{% endif %}" href="#">
                                <i class="fas fa-book"></i> Courses
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'exams' in request.path %}active{% endif %}" href="#">
                                <i class="fas fa-file-alt"></i> Exams
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'profile' in request.path %}active{% endif %}" href="#">
                                <i class="fas fa-user"></i> Profile
                            </a>
                        </li>
                    
                    {% elif user.role == 'lecturer' %}
                        <li class="nav-item">
                            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
                                <i class="fas fa-home"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'courses' in request.path %}active{% endif %}" href="{% url 'lecturer_courses' %}">
                                <i class="fas fa-book"></i> Courses
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'exams' in request.path %}active{% endif %}" href="{% url 'lecturer_exams' %}">
                                <i class="fas fa-file-alt"></i> Exams
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'analytics' in request.path %}active{% endif %}" href="{% url 'lecturer_analytics' %}">
                                <i class="fas fa-chart-bar"></i> Analytics
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'reports' in request.path %}active{% endif %}" href="{% url 'lecturer_reports' %}">
                                <i class="fas fa-file-download"></i> Reports
                            </a>
                        </li>

                    {% elif user.role == 'hod' %}
                        <!-- HOD menu items -->
                        <li class="nav-item">
                            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
                                <i class="fas fa-home"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'department' in request.path %}active{% endif %}" href="{% url 'department_management' %}">
                                <i class="fas fa-building"></i> Department
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'analytics' in request.path %}active{% endif %}" href="{% url 'hod_analytics' %}">
                                <i class="fas fa-chart-bar"></i> Analytics
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'reports' in request.path %}active{% endif %}" href="{% url 'hod_reports' %}">
                                <i class="fas fa-file-download"></i> Reports
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'settings' in request.path %}active{% endif %}" href="{% url 'department_settings' %}">
                                <i class="fas fa-cog"></i> Settings
                            </a>
                        </li>

                    {% elif user.role == 'school_admin' %}
                        <!-- School Admin menu items -->
                        <li class="nav-item">
                            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'dashboard' %}">
                                <i class="fas fa-home"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'school' in request.path %}active{% endif %}" href="{% url 'school_management' %}">
                                <i class="fas fa-university"></i> School Management
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'settings' in request.path %}active{% endif %}" href="{% url 'system_settings' %}">
                                <i class="fas fa-cog"></i> System Settings
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'analytics' in request.path %}active{% endif %}" href="{% url 'school_analytics' %}">
                                <i class="fas fa-chart-bar"></i> Analytics
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if 'reports' in request.path %}active{% endif %}" href="{% url 'school_reports' %}">
                                <i class="fas fa-file-download"></i> Reports
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            {% block main_content %}
            {% endblock %}
        </main>
    </div>
</div>
{% endblock %}

###################################################################



    <!-- Content wrapper -->
    <div class="content-wrapper">
        <!-- Navbar -->
        <nav class="navbar">
            <div class="navbar-content">
                
<button class="btn" type="button" onclick="toggleSidebar()">
    <i class="fas fa-bars"></i>
</button>

            </div>
            <a href="/dashboard/" class="navbar-brand">
                Exam Geenie
            </a>
            <div class="navbar-content ml-auto">
                
                    <span class="navbar-text">Welcome, student</span>
                    <form method="post" action="/logout/" class="d-inline">
                        <input type="hidden" name="csrfmiddlewaretoken" value="JrBmqite3Zy7JKz1enpJV0dSCqRxEj58IUZCYhsq5VF73t7v77QpIxeMGesGbszE">
                        <button class="btn btn-link nav-link" type="submit">Log Out</button>
                    </form>
                
            </div>
        </nav>

        <!-- Page content -->
        <div class="content">
            
<h1 class="mb-4">Welcome to the Exam Geenie</h1>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="card-title h5 mb-0">Your Courses</h2>
            </div>
            <div class="card-body">
                
                    
                        <ul class="list-group">
                            
                                <li class="list-group-item">
                                    <a href="/courses/1/">Arabiya (ARB 101)</a>
                                </li>
                            
                        </ul>
                    
                    <a href="/course-registration/" class="btn btn-primary mt-3">Register for Courses</a>
                
            </div>
        </div>
    </div>
    
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="card-title h5 mb-0">Upcoming Exams</h2>
            </div>
            <div class="card-body">
                
                    <p>No upcoming exams.</p>
                
            </div>
        </div>
    </div>
</div>


<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h2 class="card-title h5 mb-0">Exam Room</h2>
            </div>
            <div class="card-body">
                <p>Click the button below to enter the exam room. Your upcoming exam will start automatically when the countdown reaches zero.</p>
                <a href="/exam-room/" class="btn btn-primary">Enter Exam Room</a>
            </div>
        </div>
    </div>
</div>




        </div>
    </div>

    <script>
        // Sidebar functionality
        function toggleSidebar() {
            const body = document.body;
            if (window.innerWidth <= 768) {
                body.classList.toggle('sidebar-visible');
            } else {
                body.classList.toggle('sidebar-collapsed');
            }
        }
        
        // Close sidebar when clicking overlay on mobile
        document.addEventListener('DOMContentLoaded', function() {
            const overlay = document.querySelector('.sidebar-overlay');
            if (overlay) {
                overlay.addEventListener('click', function() {
                    document.body.classList.remove('sidebar-visible');
                });
            }

            // Initialize sidebar state
            const body = document.body;
            if (window.innerWidth <= 768) {
                body.classList.remove('sidebar-visible');
            }
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) {
                    document.body.classList.remove('sidebar-visible');
                }
            });
        });
        </script>

    

<script>
function updateCountdown() {
    const countdowns = document.querySelectorAll('.countdown');
    countdowns.forEach(countdown => {
        const examDate = new Date(countdown.dataset.examDate).getTime();
        const now = new Date().getTime();
        const distance = examDate - now;

        if (distance < 0) {
            countdown.innerHTML = "Exam has started";
            const examRoomLink = countdown.parentElement.querySelector('.exam-room-link');
            if (examRoomLink) {
                examRoomLink.classList.remove('btn-primary');
                examRoomLink.classList.add('btn-success');
                examRoomLink.textContent = 'Start Exam';
            }
        } else {
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            countdown.innerHTML = `Time remaining: ${days}d ${hours}h ${minutes}m ${seconds}s`;
        }
    });
}

setInterval(updateCountdown, 1000);
updateCountdown();
// Add event listeners to exam room links
document.querySelectorAll('.exam-room-link').forEach(link => {
    link.addEventListener('click', function(e) {
        const examId = this.dataset.examId;
        const countdown = this.parentElement.querySelector('.countdown');
        if (countdown && countdown.textContent === "Exam has started") {
            // Allow the link to work normally
        } else {
            e.preventDefault();
            alert('The exam has not started yet. Please wait for the countdown to finish.');
        }
    });
});
</script>

    <!-- Halfmoon JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha256-CDOy6cOibCWEdsRiZuaHf8dSGGJRYuBGC+mjoJimHGw=" crossorigin="anonymous"></script>



